# DR0002: Switch expression missing arm

## Summary

Switch expressions on Result types should handle both Ok and Err cases to ensure all possible states are considered.

## Details

This rule ensures that switch expressions on `Result<T, E>` types handle both the success (`Ok`) and error (`Err`) cases.
Missing cases can lead to runtime exceptions or incomplete error handling.

Note: This analyzer comes paired with the suppressor DR0003 which suppresses `CS8509` for result types.
This suppression might fail if there are compiler errors, ...

## CodeFixer

This rule provides a code fixer which adds missing arms.

## Examples

### Noncompliant

```csharp
// Missing Err case
var result = GetResult();
var value = result switch
{
    Result<int, string>.Ok(int value) => value,
    // Missing Err case
};

// Missing Ok case
var result = GetResult();
var message = result switch
{
    Result<int, string>.Err(string error) => error,
    // Missing Ok case
};
```

### Compliant

```csharp
// Handle both cases explicitly
var result = GetResult();
var value = result switch
{
    Result<int, string>.Ok(int value) => value,
    Result<int, string>.Err(string error) => 0, // Default value for error
};

// Use catch-all pattern
var result = GetResult();
var message = result switch
{
    Result<int, string>.Ok(int value) => $"Success: {value}",
    _ => "Error occurred", // Catch-all for Err case
};
```

## Configuration

### Severity

```ini
# .editorconfig
dotnet_diagnostic.DR0002.severity = error
```

## When to Suppress

Do not suppress this rule.
Not handling all cases might throw an exception which is against the intention of the result pattern.
If you have checked a specific case before, use `Expect(message)` or `ExpectError(message)` methods.

## Additional resources

- [Pattern Matching in C#](https://docs.microsoft.com/en-us/dotnet/csharp/pattern-matching)
